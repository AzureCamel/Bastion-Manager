<div class="bastion-overview-content">
  <header class="overview-header">
    <h2>
      <i class="fas fa-chess-rook"></i>
      {{localize "BASTION_MANAGER.Overview.Title"}}
    </h2>
    <div class="header-controls">
      {{#if isGM}}
      <button type="button" class="manage-btn" data-action="manageBastions" data-tooltip="{{localize 'BASTION_MANAGER.Overview.ManageBastions'}}">
        <i class="fas fa-users-cog"></i>
      </button>
      {{/if}}
      <button type="button" class="refresh-btn" data-action="refreshBastions" data-tooltip="{{localize 'BASTION_MANAGER.Overview.Refresh'}}">
        <i class="fas fa-sync"></i>
      </button>
    </div>
  </header>

  {{#if hasBastions}}
  <div class="bastion-grid" style="grid-template-columns: repeat({{columnsPerRow}}, 1fr);">
    {{#each bastions as |bastion|}}
    <div class="bastion-card {{#if bastion.isOwner}}owned{{/if}} {{#if bastion.disableFade}}no-fade{{/if}} {{#if bastion.textOutline}}text-outline{{/if}}" 
         data-actor-id="{{bastion.actorId}}"
         data-action="openBastion"
         style="background-image: url('{{bastion.bastionImg}}'); height: {{@root.cardHeight}}px; --card-accent: {{bastion.accentColor}}; --card-fade: {{bastion.fadeAmount}}; --card-text-color: {{bastion.textColor}};">
      {{#if bastion.isPublic}}
      <div class="visibility-badge public" data-tooltip="{{localize 'BASTION_MANAGER.Visibility.Public'}}">
        <i class="fas fa-globe"></i>
      </div>
      {{else if bastion.sharedWith}}
      <div class="visibility-badge shared" data-tooltip="{{localize 'BASTION_MANAGER.Visibility.Shared'}}">
        <i class="fas fa-users"></i>
      </div>
      {{/if}}
      
      {{#if bastion.canEdit}}
      <button type="button" class="card-settings-btn" data-action="openSettings" data-actor-id="{{bastion.actorId}}" data-tooltip="{{localize 'BASTION_MANAGER.ContextMenu.Settings'}}">
        <i class="fas fa-cog"></i>
      </button>
      {{/if}}
      
      <div class="card-content">
        <h3 class="bastion-name">{{bastion.bastionName}}</h3>
        <div class="card-details">
          <div class="owner-info">
            <img src="{{bastion.actorImg}}" alt="{{bastion.actorName}}" class="owner-portrait">
            <span class="owner-name">{{bastion.actorName}}</span>
          </div>
          <div class="facility-counts">
            <div class="count-item special" data-tooltip="{{localize 'DND5E.FACILITY.Types.Special.Label.other'}}">
              <i class="fas fa-building-columns"></i>
              <span>{{bastion.specialCount}}/{{bastion.specialMax}}</span>
            </div>
            <div class="count-item basic" data-tooltip="{{localize 'DND5E.FACILITY.Types.Basic.Label.other'}}">
              <i class="fas fa-chess-rook"></i>
              <span>{{bastion.basicCount}}/{{bastion.basicMax}}</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    {{/each}}
  </div>
  {{else}}
  <div class="no-bastions">
    <i class="fas fa-chess-rook"></i>
    <p>{{localize "BASTION_MANAGER.Overview.NoBastions"}}</p>
    {{#if isGM}}
    <p class="hint">{{localize "BASTION_MANAGER.Overview.NoBastionsHintGM"}}</p>
    {{else}}
    <p class="hint">{{localize "BASTION_MANAGER.Overview.NoBastionsHint"}}</p>
    {{/if}}
  </div>
  {{/if}}
</div>
